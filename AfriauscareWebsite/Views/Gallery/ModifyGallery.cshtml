@model Afriauscare.BusinessLayer.Gallery.GalleryModifyModel
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>CreateGallery</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="~/Content/bootstrap.min.css">
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/popper.min.js" type="module"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
</head>
<body>
    @Html.Partial("_MenuBarAdminPortal")

    <div class="container">
        @using (Html.BeginForm("ModifyGallery", "Gallery", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            <div class="mx-auto col-12 col-md-10 col-lg-6">
                <h2>Modify Gallery</h2>
                <br />
                @Html.HiddenFor(model => model.GalleryId)

                @if (TempData["GalleryAlertMessage"] != null)
                {
                    <div id="ModifyGalleryAlert" class="alert alert-success">
                        <button type="button" class="close" data-dismiss="alert">&times;</button>
                        <strong>Success!</strong> @TempData["GalleryAlertMessage"]
                    </div>
                }

                <div class="row">
                    <div class="col">
                        @Html.LabelFor(model => model.GalleryTitle)
                        @Html.TextBoxFor(model => model.GalleryTitle, new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => model.GalleryTitle, null, new { @class = "text text-danger" })
                    </div>
                    <div class="col">
                        @Html.LabelFor(model => model.GalleryDescription)
                        @Html.TextBoxFor(model => model.GalleryDescription, new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => model.GalleryDescription, null, new { @class = "text text-danger" })
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        @Html.LabelFor(model => model.GalleryEventDate)
                        @Html.EditorFor(model => model.GalleryEventDate, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.GalleryEventDate, null, new { @class = "text text-danger" })
                    </div>
                </div>
                <br />
                <fieldset class="border p-1">
                    <input type="hidden" id="GalleryIdHidden" value="@Model.GalleryId" />
                    <legend class="w-auto">Image Management</legend>
                    @Html.Label("Select an action")
                    <select name="ImageActionSelect" id="ImageActionSelect" class="form-control">
                        <option value="1">Add images</option>
                        <option value="2">Delete images</option>
                    </select>
                    <br />
                    <br />

                    <div class="form-group" id="AddImagesDiv">
                        <div class="col-md-10">
                            @Html.TextBoxFor(model => model.imageList, "", new { @type = "file", @multiple = "multiple" })
                        </div>
                        @Html.ValidationMessageFor(model => model.imageList, "", new { @class = "text-danger" })
                    </div>

                </fieldset>

                <div id="DeleteImagesModal" class="modal fade" tabindex="-1" role="dialog">
                    <div class="modal-dialog modal-lg">
                        
                    </div>
                </div>

                <div class="form-group">
                    @Html.ValidationMessage("Error", null, new { @class = "text text-danger col-sm-10" })
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">Modify Gallery</button>
                    <button type="button" class="btn btn-secondary" onclick="location.href='@Url.Action("ViewGallery", "Gallery")'">Back</button>
                </div>
            </div>
        }
    </div>

    <script>
        $(document).ready(function () {
            $('#AddImagesDiv').show();

            setTimeout(function () {

                // Closing the alert message once the user is created
                $('#ModifyGalleryAlert').alert('close');
            }, 5300);

            $('#ImageActionSelect').change(function () {
                var ddlValue = $(this).val();

                if (ddlValue == "1") {
                    // show time div, hide fromTo div
                    $('#AddImagesDiv').show();
                }
                else if (ddlValue == "2") {

                    var id = $('#GalleryIdHidden').val();
                    $.ajax({
                        url: "@Url.Action("ViewGalleryContentDelete", "Gallery")",
                        data: { galleryId: id },
                        success: function (data) {
                            $("#DeleteImagesModal .modal-dialog").html(data);
                            $("#DeleteImagesModal").modal("show");
                        }
                    });

                    $("#DeleteImagesModal").modal("show");
                    $('#AddImagesDiv').hide();
                }
            });
        });
    </script>
</body>
</html>
